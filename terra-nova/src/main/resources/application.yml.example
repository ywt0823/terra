terra:
  framework:
    ai:
      enabled: true
      default-model-id: "openai:gpt-3.5-turbo"
      models:
        # OpenAI模型配置
        "openai:gpt-3.5-turbo":
          type: "OPENAI"
          endpoint: "https://api.openai.com/v1"
          apiKey: "your-api-key"
          timeout: 30000
          streamSupport: true
          defaultParameters:
            temperature: 0.7
            max_tokens: 1000
          retry:
            maxRetries: 3
            initialDelayMs: 1000
            maxDelayMs: 10000
            backoffMultiplier: 2.0
            retryableErrors:
              - "timeout"
              - "rate_limit_exceeded"
              - "server_error"
              - "service_unavailable"
        
        # Claude模型配置
        "claude:claude-3-opus":
          type: "CLAUDE"
          endpoint: "https://api.anthropic.com/v1"
          apiKey: "your-api-key"
          timeout: 60000
          streamSupport: true
          defaultParameters:
            temperature: 0.7
            max_tokens: 4000
        
        # 文心一言模型配置
        "wenxin:ernie-bot-4":
          type: "WENXIN"
          endpoint: "https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat"
          apiKeyId: "your-api-key-id"
          apiKeySecret: "your-api-key-secret"
          authType: "AK_SK"
          timeout: 30000
          streamSupport: true
          defaultParameters:
            temperature: 0.7
            top_p: 0.8
        
        # 通义千问模型配置
        "tongyi:qwen-max":
          type: "TONGYI"
          endpoint: "https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation"
          apiKey: "your-api-key"
          timeout: 30000
          streamSupport: true
          defaultParameters:
            temperature: 0.7
            top_p: 0.8
        
        # DeepSeek模型配置
        "deepseek:deepseek-chat":
          type: "DEEPSEEK"
          endpoint: "https://api.deepseek.com/v1"
          apiKey: "your-api-key"
          timeout: 30000
          streamSupport: true
          defaultParameters:
            temperature: 0.7
            top_p: 0.8
            
        # DeepSeek嵌入模型配置
        "deepseek:text-embedding":
          type: "DEEPSEEK"
          endpoint: "https://api.deepseek.com/v1"
          apiKey: "your-api-key"
          timeout: 30000
          streamSupport: false
          defaultParameters:
            dimensions: 1024
        
        # Dify模型配置
        "dify:default":
          type: "DIFY"
          endpoint: "https://api.dify.ai/v1"
          apiKey: "your-api-key"
          timeout: 30000
          streamSupport: true

  nova:
    # AI服务配置
    ai:
      enabled: true
      default-model-id: openai:gpt-3.5-turbo
      providers:
        openai:
          api-key: ${OPENAI_API_KEY:sk-xxx}
          organization-id: ${OPENAI_ORG_ID:}
          timeout: 30000
        claude:
          api-key: ${CLAUDE_API_KEY:sk-xxx}
          timeout: 60000
        wenxin:
          api-key-id: ${WENXIN_API_KEY_ID:xxx}
          api-key-secret: ${WENXIN_API_KEY_SECRET:xxx}
          timeout: 30000
        deepseek:
          api-key: ${DEEPSEEK_API_KEY:sk-xxx}
          timeout: 30000
        coze:
          api-key: ${COZE_API_KEY:xxx}
          bot-id: ${COZE_BOT_ID:xxx}
        ollama:
          base-url: ${OLLAMA_BASE_URL:http://localhost:11434}
    
    # 对话功能配置
    conversation:
      enabled: true
      max-messages-per-conversation: 100
    
    # 函数调用配置
    function:
      enabled: true
      base-packages: com.terra.framework.nova.function
    
    # 提示词配置
    prompt:
      enabled: true
      template-location: classpath:prompts/
    
    # RAG检索增强生成配置
    rag:
      enabled: true
      # 文档分割配置
      splitting:
        chunk-size: 1000
        overlap: 200
        splitter: character
      # 检索配置
      retrieval:
        top-k: 5
        rerank: true
        rerank-model: ""
        minimum-score: 0.7
      # 上下文构建配置
      context:
        template: |
          根据以下上下文回答问题:
          
          {context}
          
          问题: {question}
        max-tokens: 3500
        format-documents: true
        document-template: "文档[{index}]: {content}\n来源: {source}"
      # 向量存储配置
      vector-store:
        type: in-memory
        url: localhost:19530
        collection-name: documents
    
    # 重排序配置
    rag.rerank:
      enabled: true
      type: cross-encoder
      model-id: "deepseek:deepseek-chat"
      threshold: 0.3
      max-documents: 50
      # 交叉编码器配置
      cross-encoder:
        model-name: ms-marco-MiniLM-L-6-v2
        batch-size: 16
      # LLM重排序配置  
      llm-rerank:
        prompt-template: |
          请评估以下文档与问题"{query}"的相关性，返回0到100之间的相关性分数。
          
          文档内容：{content}
        temperature: 0.0
        parameters:
          max_tokens: 10
    
    # 嵌入服务配置
    rag.embedding:
      enabled: true
      model-id: "deepseek:text-embedding"
      model-type: "deepseek"
      dimension: 1024
      batch-size: 20
      cache-enabled: true
      cache-size: 1000
      cache-ttl-seconds: 3600
    
    # 缓存配置
    cache:
      enabled: true
      ttl-seconds: 3600
    
    # 重试配置
    retry:
      enabled: true
      max-retries: 3
      initial-delay-ms: 1000
      max-delay-ms: 10000
    
    # 监控配置
    monitoring:
      enabled: true
    
    # 模型混合配置
    blend:
      enabled: true
      strategy: WEIGHTED

    # Agent代理系统配置
    agent:
      enabled: true
      default-type: REACT
      default-model-id: gpt-4
      max-steps: 10
      timeout-ms: 60000
      thread-pool-size: 10
      base-packages: com.terra.framework.nova
      
      # 工具配置
      tool:
        auto-register: true
        base-packages: com.terra.framework.nova.agent.tool.scanner.tools
        timeout-ms: 30000
      
      # 对话集成
      conversation:
        enabled: true
        record-steps: false
      
      # ReAct代理配置
      react:
        prompt-template-id: agent.react
        backtracking-enabled: true
        backtracking-depth: 3
      
      # Plan-and-Execute代理配置
      plan-and-execute:
        planner-prompt-template-id: agent.planner
        executor-prompt-template-id: agent.executor
        max-plan-steps: 5

logging:
  level:
    com.terra.framework.nova: INFO 